{
    "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
    "name": "Touhou Danmakufu",
    "scopeName": "source.eps",
    "patterns": [
        {
            "match": "//.*$\\n?",
            "name": "comment.line.double-slash.eps"
        },
        {
            "begin": "/\\*",
            "end": "\\*/",
            "name": "comment.block.eps"
        },
        {
            "match": "\\b\\d+\\b",
            "name": "constant.numeric.eps"
        },
        {
            "match": "\\b(true|false|True|False)\\b",
            "name": "constant.language.eps"
        },
        {
            "match": "\\b(EV)_[\\w_]+\\b",
            "name": "variable.parameter.enum.event.eps"
        },
        {
            "match": "\\b(ID_INVALID|KEY_INVALID|OBJ_[\\w_]+|TYPE_[\\w_]+|ITEM_[\\w_]+)\\b",
            "name": "variable.parameter.enum.other.eps"
        },
        {
            "match": "\\b(BLEND_ALPHA|BLEND_ADD_RGB|BLEND_ADD_ARGB|BLEND_MULTIPLY|BLEND_SUBTRACT|BLEND_INV_DESTRGB)\\b",
            "name": "variable.parameter.enum.blendtype.eps"
        },
        {
            "comment": "Import statements used to correctly mark `import`, and `as`\n",
            "name": "meta.import.eps",
            "begin": "\\b(?<!\\.)(import)\\b",
            "end": "(?=;|$|^)",
            "beginCaptures": {
                "1": {
                    "name": "keyword.control.import.eps"
                }
            },
            "patterns": [
                {
                    "name": "keyword.control.import.eps",
                    "match": "\\b(?<!\\.)as\\b"
                }
            ]
        },
        {
            "match": "\\b(INFO_SCRIPT_TYPE|INFO_SCRIPT_PATH|INFO_SCRIPT_ID|INFO_SCRIPT_TITLE|INFO_SCRIPT_TEXT|INFO_SCRIPT_IMAGE|INFO_SCRIPT_REPLAY_NAME|INFO_LIFE|INFO_DAMAGE_RATE_SHOT|INFO_DAMAGE_RATE_SPELL|INFO_SHOT_HIT_COUNT|INFO_IS_SPELL|INFO_IS_LAST_SPELL|INFO_IS_DURABLE_SPELL|INFO_IS_LAST_STEP|INFO_TIMER|INFO_TIMERF|INFO_ORGTIMERF|INFO_SPELL_SCORE|INFO_REMAIN_STEP_COUNT|INFO_ACTIVE_STEP_LIFE_COUNT|INFO_ACTIVE_STEP_TOTAL_MAX_LIFE|INFO_ACTIVE_STEP_TOTAL_LIFE|INFO_PLAYER_SHOOTDOWN_COUNT|INFO_PLAYER_SPELL_COUNT|INFO_ACTIVE_STEP_LIFE_RATE_LIST|INFO_CURRENT_LIFE|INFO_CURRENT_LIFE_MAX|INFO_RECT|INFO_DELAY_COLOR|INFO_BLEND|INFO_COLLISION|INFO_COLLISION_LIST|INFO_ITEM_SCORE|REPLAY_FILE_PATH|REPLAY_DATE_TIME|REPLAY_USER_NAME|REPLAY_TOTAL_SCORE|REPLAY_FPS_AVERAGE|REPLAY_PLAYER_NAME|REPLAY_STAGE_INDEX_LIST|REPLAY_STAGE_START_SCORE_LIST|REPLAY_STAGE_LAST_SCORE_LIST|REPLAY_COMMENT)\\b",
            "name": "variable.parameter.enum.infotype.eps"
        },
        {
            "match": "\\b(alternative|ascent|break|case|descent|else|if|in|local|loop|return|others|times|while|yield)\\b",
            "name": "keyword.control.flow.eps"
        },
        {
            "match": "^\\s*#(TouhouDanmakufu|ScriptVersion|ID|Title|Text|Image|System|Background|BGM|Player|ReplayName|UserShotData|UserItemData)\\b",
            "name": "keyword.control.header.eps"
        },
        {
            "match": "^\\s*#include\\b",
            "name": "keyword.control.include.eps"
        },
        {
            "match": "\\b(add|append|concatenate|divide|erase|index|length|multiply|not|negative|power|predecessor|remainder|result|slice|successor|subtract)\\b",
            "name": "keyword.operator.textual.eps"
        },
        {
            "match": "==|!=|<=|&rt;=|<|&rt;|\\|\\||&&|~|!",
            "name": "keyword.operator.logical.eps"
        },
        {
            "match": "\\+=|\\+|-=|-|\\*=|\\*|/=|/|%|\\^|\\(\\||\\|\\)",
            "name": "keyword.operator.symbol.eps"
        },
        {
            "match": "^\\s*(var|const)\\b",
            "name": "storage.type.variable.eps"
        },
        {
            "begin": "'",
            "end": "'",
            "name": "string.quoted.single.eps"
        },
        {
            "begin": "(?<!\\\\)\"",
            "end": "(?<!\\\\)\"",
            "name": "string.quoted.double.eps"
        },
        {
            "match": "\\bfunction\\s+(onPluginStart|beforeTriggerExec|afterTriggerExec)\\b",
            "name": "entity.name.function.predefined.eps"
        },
        {
            "match": "\\b(ShotData|ItemData)\\b",
            "name": "entity.name.function.data.eps"
        },
        {
            "begin": "^\\s*(function)\\b",
            "beginCaptures": {
                "1": {
                    "name": "storage.type.function.eps"
                }
            },
            "end": "\\{",
            "name": "meta.function.eps",
            "patterns": [
                {
                    "begin": "([A-Za-z_]\\w*)\\s*\\(",
                    "beginCaptures": {
                        "1": {
                            "name": "entity.name.function.eps"
                        }
                    },
                    "end": "\\)",
                    "name": "meta.function.identifier.eps",
                    "patterns": [
                        {
                            "match": "\\b[A-Za-z_]\\w*\\b",
                            "name": "variable.parameter.eps"
                        }
                    ]
                },
                {
                    "match": "[A-Za-z_]\\w*\\s*",
                    "name": "entity.name.function.eps"
                }
            ]
        },
        {
            "match": ":",
            "name": "invalid.eps"
        }
    ]
}